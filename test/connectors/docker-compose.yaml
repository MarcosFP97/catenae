version: '3.4'

x-logging: &default-logging
  options:
    max-size: '50m'
    max-file: '1'
  driver: json-file

services:

  kafka:
    image: catenae/kafka
    volumes:
      - ./kafka/config/server.properties:/opt/kafka/default/config/server.properties:ro
    logging: *default-logging

  aerospike:
    image: aerospike/aerospike-server:4.3.0.7
    volumes:
      - ./aerospike/etc/aerospike.conf:/opt/aerospike/etc/aerospike.conf:ro
    ports:
      - 3000:3000
    command: --config-file /opt/aerospike/etc/aerospike.conf
    logging: *default-logging

  mongodb:
    image: mongo:4.0-xenial
    ports:
      - 27017:27017
    logging: *default-logging

  aerospike_connector:
    image: catenae/test
    command: aerospike_connector.py -o input1 -b kafka:9092
    working_dir: /opt/catenae/test/connectors
    depends_on:
      - kafka
